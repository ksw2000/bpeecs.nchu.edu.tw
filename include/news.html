<h1 id="title"></h1>

<script>
    let getParam = new URL(window.location.href).searchParams;
    if(getParam.has('id')){
        loadPublicNewsById(getParam.get('id')).then((json_data) => {
            /*
                json_data.text : html data
                json_data.json : original data from db (but some data are modified)
            */
            console.log(json_data);
            $("#article-parent").html(json_data.text);
            $("h1#title").text(json_data.json.Title);
        }).catch((reason) => {
            $("#article-parent").html("Article not found");
        });
    }else{
        let type = getParam.get('type');
        let lnfw;
        console.log(type);
        if(type === null){
            $("h1#title").text("最新消息");
            lnfw = new loadNewsForWhat('brief', 'public', null, 0, 19);
        }else{
            $("h1#title").text(articleTypeDecoder(type) + " ／ 最新消息");
            lnfw = new loadNewsForWhat('brief', 'public-with-type', type, 0, 19);
        }

        lnfw.load().then((html_data) => {
            $("#article-parent").html(html_data);
        }).catch((reason) => {
            console.log(reason);
            $("#article-parent").html("Error " + reason.status);
        });
        window.lnfw = lnfw;
    }

    function loadNext(obj){
        window.lnfw.next().then((data) => {
            $("#article-parent").append(data);
            obj.remove();
        }).catch((reason) => {
            console.log(reason);
            notice("Error " + reason.status);
        })
    }
</script>

<div id="article-parent">
Loading...
</div>
